(function(a){a.fn.typeshow=function(b){b=b?b:{};var c=a.extend({},a.fn.typeshow.defaults,b);this.each(function(){if(this.tagName==="DIV"){var e=a(this);var f;f=a.metadata?a.extend({},c,e.metadata()):c;if(f.folder.length===0){f.folder="./"}else{f.folder+="/"}this.TypeShow=f;e.addClass("ts_typeshow");e.html(a.fn.typeshow.template);a.fn.typeshow.instances.push(this);var d=a.fn.typeshow.instances.length-1;e.data("TS_ID",d);if(!a.fn.typeshow.isReady(this)){a.fn.typeshow.prepare(this)}else{a.fn.typeshow.start(this)}}});return this};a.fn.typeshow.defaults={folder:"",indexfile:"",text:"",fonts:[],themes:[],pangrams:[],settings:{},usePangrams:true,allowExternalLinks:true,settingsFile:"cache/setup.json",delay:800,onReady:function(){}};a.fn.typeshow.start=function(c){var f=c.TypeShow;if(f.text===""){f.text=a.fn.typeshow.getPangram(c)}a(".ts_text",c).val(f.text);a.fn.typeshow.setFonts(c);a.fn.typeshow.setThemes(c);a("select.ts_dropdown_fonts",c).change(function(h){var g=a.fn.typeshow.getInstance(h.target);var i=a(this).val();var j=g.TypeShow.fonts;a.each(j,function(l,k){if(k.name===i){a.fn.typeshow.setStyles(g,k.styles);if(g.TypeShow.settings.infolink.display==="Y"&&k.url!==""){a.fn.typeshow.setInfo(g,k)}else{a(".ts_font_info").hide()}}});a.fn.typeshow.update(true)});a("select.ts_dropdown_styles",c).change(function(g){a.fn.typeshow.update(true)});a("select.ts_dropdown_themes",c).change(function(g){a.fn.typeshow.update(true)});a(".ts_text",c).change(function(h){var g=a.fn.typeshow.getInstance(h.target);if(a(this).val()!==g.TypeShow.text){a.fn.typeshow.update(h)}}).keyup(function(h){var g=a.fn.typeshow.getInstance(h.target);if(a(this).val()!==g.TypeShow.text){a.fn.typeshow.update(h)}}).focus(function(g){g.target.select()});if(f.settings.dimensions){var d=f.settings.dimensions.width;var e=f.settings.dimensions.height;a(c).css("width",d+"px");a(".ts_image",c).css({width:d+"px",height:e+"px"});var b=a(".ts_text",c);a(".ts_text",c).css("width",(d-parseInt(b.css("paddingLeft"))-parseInt(b.css("paddingRight")))-parseInt(b.css("borderLeftWidth"))-parseInt(b.css("borderRightWidth"))+"px")}a(".ts_image",c).attr("alt","TypeShow font sample is loading...");a.fn.typeshow.update(true);f.onReady(c)};a.fn.typeshow.isReady=function(b){var d=b.TypeShow;var c=d.usePangrams?d.pangrams.length>0:true;return(d.settings.dimensions&&d.fonts.length>0&&d.themes.length>0&&c)};a.fn.typeshow.update=function(e,d){if(d===true){for(var c=0;c<a.fn.typeshow.instances.length;c++){var b=a.fn.typeshow.instances[c];a(".ts_image",b).get(0).src=a.fn.typeshow.getImageSource(b);a(".ts_text",b).removeClass("loading")}}else{var b=a.fn.typeshow.getInstance(e.target);a(".ts_text",b).addClass("loading");if(a.fn.typeshow.timer){window.clearTimeout(a.fn.typeshow.timer)}a.fn.typeshow.timer=window.setTimeout("$.fn.typeshow.update(null,true)",a.fn.typeshow.defaults.delay)}};a.fn.typeshow.getImageSource=function(b,d){d=d?d:a(".ts_text",b).val();if(d===""){if(a.fn.typeshow.supportsSelect()){d=a.fn.typeshow.getPangram(b);a(".ts_text",b).val(d).select()}}b.TypeShow.text=d;var c=new Date();return b.TypeShow.folder+b.TypeShow.indexfile+"?s="+encodeURIComponent(d)+"&font="+encodeURIComponent(a(".ts_dropdown_fonts",b).val())+"&style="+encodeURIComponent(a(".ts_dropdown_styles",b).val())+"&theme="+encodeURIComponent(a(".ts_dropdown_themes",b).val())+"&cache="+c.getHours()+c.getMinutes()+c.getSeconds()+c.getMilliseconds()};a.fn.typeshow.getPangram=function(b){var d=b.TypeShow;if(d.usePangrams&&d.pangrams.length>0){var c=d.pangrams[Math.round(Math.random()*(d.pangrams.length-1))];return c.text}else{return""}};a.fn.typeshow.setFonts=function(b,d,c){c=c?c:b.TypeShow.settings.defaults.font;a.each(b.TypeShow.fonts,function(f,e){a("select.ts_dropdown_fonts",b).append('<option value="'+e.name+'" '+(c===e.name?'selected="selected"':"")+">"+e.name+"</option>");if(e.name===c){a.fn.typeshow.setStyles(b,e.styles);a.fn.typeshow.setInfo(b,e)}})};a.fn.typeshow.setStyles=function(b,e){e=e?e:[];var c=a(".ts_dropdown_styles",b).get(0);var d=c.value||b.TypeShow.settings.defaults.style;while(c.firstChild){c.removeChild(c.firstChild)}a.each(e,function(f,g){a("select.ts_dropdown_styles",b).append('<option value="'+g.name+'"'+(g.name===d?'selected="selected"':"")+">"+g.name+"</option>")})};a.fn.typeshow.setThemes=function(b,c){c=c?c:b.TypeShow.settings.defaults.theme;a.each(b.TypeShow.themes,function(d,e){a("select.ts_dropdown_themes",b).append('<option value="'+e.name+'"'+(c===e.name?'selected="slected"':"")+">"+e.name+"</option>")})};a.fn.typeshow.setInfo=function(b,c){var d=b.TypeShow.settings.infolink.description;d=a.fn.typeshow.replace(d,"%font%",c.name);d=a.fn.typeshow.replace(d,"%foundry%",c.foundry);d=a.fn.typeshow.replace(d,"%designer%",c.designer);a(".ts_font_info",b).html('<a href="'+c.url+'" class="ts_font_link">'+d+"</a>").show()};a.fn.typeshow.replace=function(b,d,c){if(b.indexOf(d)>=0){b=b.substr(0,b.indexOf(d))+c+b.substr(b.indexOf(d)+d.length)}return b};a.fn.typeshow.prepare=function(b){var c=b.TypeShow;a.getJSON(c.folder+c.settingsFile,function(d){if(!c.settings.dimensions&&d.settings){c.settings=d.settings}if(c.fonts.length===0&&d.fonts){c.fonts=d.fonts}if(c.themes.length===0&&d.themes){c.themes=d.themes}if(c.pangrams.length===0&&d.pangrams){c.pangrams=d.pangrams}if(c.allowExternalLinks===true){var e=a.fn.typeshow.getUrlParams();if(e["ts-font"]){c.settings.defaults.font=decodeURIComponent(e["ts-font"])}if(e["ts-style"]){c.settings.defaults.style=decodeURIComponent(e["ts-style"])}if(e["ts-theme"]){c.settings.defaults.theme=decodeURIComponent(e["ts-theme"])}}a.fn.typeshow.start(b)})};a.fn.typeshow.getInstance=function(b){var c=a(b).parents(".ts_typeshow").data("TS_ID");return a.fn.typeshow.instances[c]};a.fn.typeshow.resetAll=function(){a.fn.typeshow.instances=[];a.fn.typeshow.init=false;a.fn.typeshow.timer=null};a.fn.typeshow.supportsSelect=function(){var b=navigator.userAgent.toLowerCase();var c=(b.indexOf("iphone")!==-1||b.indexOf("ipad")!==-1);return !c};a.fn.typeshow.getUrlParams=function(){var e=[],d;var b=window.location.href.slice(window.location.href.indexOf("?")+1).split("&");for(var c=0;c<b.length;c++){d=b[c].split("=");e.push(d[0]);e[d[0]]=d[1]}return e};a.fn.typeshow.instances=[];a.fn.typeshow.init=false;a.fn.typeshow.timer=null;a.fn.typeshow.template='<img class="ts_image" alt="TypeShow requires JavaScript to be turned on in your browser." src="blanko"><form onsubmit="return false;" method="get" action="" class="ts_controls"><label for="ts_text"><span>Type here</span></label><input name="ts_text" type="text" class="ts_text" size="97" maxlength="97" value="" tabindex="0" /><div class="ts_fonts"><label for="ts_dropdown_fonts">Font</label><select class="ts_dropdown_fonts" tabindex="1"></select><select class="ts_dropdown_styles" tabindex="2"></select></div><div class="ts_themes"><label for="ts_dropdown_themes">Theme </label><select class="ts_dropdown_themes" tabindex="3"></select></div></form><div class="ts_font_info"></div><div class="ts_clear">'})(jQuery);